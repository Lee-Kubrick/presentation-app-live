<!DOCTYPE html>
<html>
<head>
  <title>Live Voting</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 100px;
    }
    button {
      padding: 15px 30px;
      font-size: 18px;
      margin: 10px;
      background: deepskyblue;
      border: none;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }
    h1 {
      color: #333;
    }
  </style>
</head>
<body>

<h1 id="question-text">Loading question...</h1>
<div id="buttons"></div>

<script>
const questions = [
  {
    question: "How old are you?",
    options: ['<13', '13‚Äì14', '15‚Äì16', '17‚Äì18', '>18']
  },
  {
    question: "What‚Äôs your favorite time to scroll TikTok?",
    options: ['Before bed', 'Lunch', 'After school', 'During class üòè', 'Never']
  },
  {
    question: "How many hours do you spend on screens daily?",
    options: ['<2', '2‚Äì4', '4‚Äì6', '6‚Äì8', '8+']
  },
  {
    question: "Your dream weekend looks like...?",
    options: ['Gaming', 'Netflix', 'Sports', 'Outside', 'Sleeping']
  },
  {
    question: "What social platform do you vibe with most?",
    options: ['TikTok', 'Snapchat', 'Instagram', 'YouTube', 'Discord']
  },
  {
    question: "Your vibe is more...",
    options: ['Introvert', 'Extrovert', 'Depends on the day']
  },
  {
    question: "What school subject do you like the most?",
    options: ['Math', 'Science', 'English', 'Art', 'Gym']
  },
  {
    question: "How do you learn best?",
    options: ['Visual', 'Hands-on', 'Listening', 'Reading/Writing']
  },
  {
    question: "What music gets you hyped?",
    options: ['Hip-hop', 'Pop', 'Rock', 'Chill', 'EDM']
  },
  {
    question: "Would you let AI write your homework?",
    options: ['Absolutely', 'Maybe', 'No way', 'Already did ü§´']
  }
];

let socket = io("https://presentation-app-live.onrender.com");
const user_id = Math.random().toString(36).substring(2, 10);
let currentQuestion = 0;

function renderQuestion(index) {
  const container = document.getElementById('buttons');
  const title = document.getElementById('question-text');
  container.innerHTML = '';
  const q = questions[index];
  title.innerText = q.question;
  q.options.forEach((text, i) => {
    const btn = document.createElement("button");
    btn.innerText = text;
    btn.onclick = () => {
      socket.emit('submit_vote', {
        user_id: user_id,
        choice: i,
        question: index
      });
      [...container.children].forEach(b => b.style.background = 'deepskyblue');
      btn.style.background = "green";
    };
    container.appendChild(btn);
  });
}

socket.on('connect', () => {
  renderQuestion(currentQuestion);
});

socket.on('set_question', (index) => {
  currentQuestion = index;
  renderQuestion(currentQuestion);
});
</script>
</body>
</html>
